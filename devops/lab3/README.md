# Отчёт по третей лабе обычной

## Плохая практика 1

Запускать джобу на последней доступной версии

Например

```runs-on: ubuntu-latest```

Если последняя версия будет не совместима с используемыми приложениями или командами, которые использовались при создании, то CI/CD будет падать с ошибкой.

Чтобы исправить я указываю конкретную версию:

```runs-on: ubuntu-20.04```

## Плохая практика 2

Не использовать нейминг в джобах

Например вместо
```
- name: Set up Python
uses: actions/setup-python@v4
with:
  python-version: '3.11'
```
Писать
```
uses: actions/setup-python@v4
with:
  python-version: '3.11'
```
Не всегда понятно, что происходит, а такой нейминг позволяет гораздо быстрее и легче ориентироваться в пайплайне

## Плохая практика 3

Не использование зависимостей для джобов

Допустим какая-то джоба должна запускаться только, если другая выполниться без ошибок (в моём случае это деплой приложения deploy после публикации контейнера publish), то нужно это явно прописать в пайплайне:

```
  publish_and_tests:
    ...
  deploy:
    needs: publish_and_tests
    ...
```

## Плохая практика 4

Тесты и публикация образа на докер хаб в одной джобе. Это осложняет читаемость и отладку.

```
  publish_and_tests:
    ...
  deploy:
    ...
```

В "хорошем" CI/CD я разделил эту джобу на две. В итоге получил такой пайплайн:

```
  run_tests:
    ...
  publish:
  needs: run_tests
    ...
  deploy:
    needs: publish
    ...
```

## Плохая практика 5

У джобов нет ограничения по времени, так что теоретически, они могут выполняться бесконечно, либо очень долго, особенно, когда происходят запросы в интернет.

Чтобы это исправить, добавляю ограничение на исполнение в 10 минут:

```
  run_tests:
    runs-on: ubuntu-20.04
    timeout-minutes: 10
    ...
    
  publish:
    needs: run_tests
    runs-on: ubuntu-20.04
    timeout-minutes: 10
    ...
    
  deploy:
    needs: [ publish ]
    runs-on: ubuntu-20.04
    timeout-minutes: 10
    ...
```